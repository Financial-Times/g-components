import { Meta, Story, Preview } from '@storybook/addon-docs/blocks';
import '../../shared/critical-path.scss';
import Observer from 'react-scroll-percentage';
import Sticky from './';

<Meta title="Core|Sticky" component={Sticky} />

# Sticky component

`<Sticky>` can be used to do sticky-positioned scrolling interactive graphics,
as popularised by The Pudding. The key thing to remember is that `<Sticky>`
takes two props, each of which is an element-returning function:

- `article({percentage, inView, updateGraphic})`

  _ \`Percentage\` is total % of container element scrolled.
  _ \`inView\` is whether the container is in the viewport.

  - \`updateGraphic\` is a function that can be used to pass a label to the
    container element's state (and then on to the graphic itself).

- `graphic({percentage, inView, current})`

  - \`Percentage\` is total % of container element scrolled
  - \`inView\` is whether the container is in the viewport
  - \`current\` is the label currently set by the article in terms of what's visible

See the "complex case" story for how to use updateGraphic

<Preview>
  <Story name="Basic">
    <div
      style={{
        backgroundColor: 'rgba(155, 155, 155, 0.7)',
        marginBottom: '100vh',
        marginTop: '20vh',
      }}
    >
      <Sticky
        graphic={({ percentage, inView }) => (
          <h1 style={{ backgroundColor: '#969696', padding: '1em' }}>
            Percentage: {(percentage * 100).toFixed(1)}% <br /> In viewport: {inView ? 'yes' : 'no'}
          </h1>
        )}
        article={({ percentage, inView }) => (
          <div style={{ fontSize: '500%' }}>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
            <h1>
              Lorem ipsum; pct:
              {percentage}; inview:
              {inView}
            </h1>
          </div>
        )}
      />
    </div>
  </Story>
</Preview>

<Preview>
  <Story name="Complex case">
    <div
      style={{
        backgroundColor: 'rgba(155, 155, 155, 0.7)',
        marginBottom: '100vh',
        marginTop: '20vh',
      }}
    >
      <Sticky
        graphic={({ percentage, inView, current }) => (
          <h1 style={{ backgroundColor: '#969696', padding: '1em' }}>
            Percentage: {(percentage * 100).toFixed(1)}% <br /> Frame is in viewport:{' '}
            {inView ? 'yes' : 'no'}
            <br /> Currently viewing line: {current}
          </h1>
        )}
        article={({ updateGraphic }) => (
          <div style={{ fontSize: '500%' }}>
            {['one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight'].map((label, idx) => (
              <Observer>
                {({ inView }) => {
                  if (inView) updateGraphic(idx);
                  return <h1>{label}</h1>;
                }}
              </Observer>
            ))}
          </div>
        )}
      />
    </div>
  </Story>
</Preview>
